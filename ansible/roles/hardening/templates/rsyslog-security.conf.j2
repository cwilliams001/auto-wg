# Security logging configuration
# Generated by Auto-WG Ansible

# Log authentication and authorization messages to separate files
auth,authpriv.*                 /var/log/auth.log
*.*;auth,authpriv.none          -/var/log/syslog

# Log kernel messages to separate file
kern.*                          -/var/log/kern.log

# Log mail system messages
mail.*                          -/var/log/mail.log

# Log daemon messages
daemon.*                        -/var/log/daemon.log

# Log cron messages
cron.*                          -/var/log/cron.log

# Security and audit logging
*.info;mail.none;authpriv.none;cron.none    /var/log/messages

# Emergency messages to all users
*.emerg                         :omusrmsg:*

# UFW firewall logging
:msg,contains,"[UFW"            /var/log/ufw.log
& stop

# Fail2ban logging
:programname,isequal,"fail2ban" /var/log/fail2ban.log
& stop

# WireGuard service logging
:programname,isequal,"wg_service" /var/log/wireguard.log
& stop

# SSH logging (additional)
:programname,isequal,"sshd"     /var/log/ssh.log
& stop

# Log rotation triggers
$WorkDirectory /var/spool/rsyslog
$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat
$IncludeConfig /etc/rsyslog.d/*.conf

# Send critical security events to a central log (if configured)
# *.crit                        @@logserver.example.com:514