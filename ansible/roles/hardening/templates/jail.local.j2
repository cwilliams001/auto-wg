# Fail2ban local configuration
# Generated by Auto-WG Ansible

[DEFAULT]
# Ban settings
bantime = 3600
findtime = 600
maxretry = 3
backend = systemd

# Email notifications (configure if needed)
destemail = root@localhost
sender = fail2ban@{{ ansible_hostname }}
mta = sendmail

# Default action
action = %(action_mwl)s

[sshd]
enabled = true
port = ssh
filter = sshd
logpath = /var/log/auth.log
maxretry = 3
bantime = 3600
findtime = 600

[nginx-http-auth]
enabled = false

[nginx-limit-req]
enabled = false

[apache-auth]
enabled = false

[apache-badbots]
enabled = false

[apache-noscript]
enabled = false

[apache-overflows]
enabled = false

# Custom jail for WireGuard service
[wireguard]
enabled = true
port = {{ wg_service_port }}
filter = wireguard
logpath = {{ wg_service_dir }}/wg_service.log
maxretry = 5
bantime = 7200
findtime = 300

# UFW jail
[ufw]
enabled = true
port = all
filter = ufw
logpath = /var/log/ufw.log
maxretry = 3
bantime = 3600

# Additional protection against port scans
[portscan]
enabled = true
filter = portscan
logpath = /var/log/syslog
maxretry = 1
bantime = 86400

[recidive]
enabled = true
filter = recidive
logpath = /var/log/fail2ban.log
action = %(action_mwl)s
bantime = 604800  # 1 week
findtime = 86400   # 1 day
maxretry = 5