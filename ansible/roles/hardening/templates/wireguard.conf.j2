# Fail2ban filter for WireGuard service
# Generated by Auto-WG Ansible

[INCLUDES]
before = common.conf

[Definition]
# Detect authentication failures in WireGuard service logs
failregex = ^.*SECURITY_EVENT.*auth_failure.*client_ip.*<HOST>.*$
            ^.*ERROR.*Unauthorized.*<HOST>.*$
            ^.*WARNING.*Invalid.*<HOST>.*$

# Ignore legitimate traffic
ignoreregex = ^.*SECURITY_EVENT.*config_generated.*<HOST>.*$
              ^.*INFO.*Successfully.*<HOST>.*$

# Date pattern for log parsing
datepattern = ^%%Y-%%m-%%d %%H:%%M:%%S